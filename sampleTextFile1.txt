This is a the new updated file here.
Some new code changes are added.
